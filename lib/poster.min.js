((function(){(function(a){var b;return b=function(){function b(b,c){this.el=b,this.options=a.extend({},this.defaults,c),this.keepSpans=a("span.lettering",b).length,this.text=String(_.trim(b.text())),this.words=this.keepSpans?[]:this.text.split(" "),this.viewportWidth=a(window).width(),this.container=this.options.container?this.el.parents(this.options.container):this.el,this.ratio=1,this.resize(),this.origFontSize=0}return b.prototype.defaults={padding:!1,wrapAmpersand:!0,headerBreakpoint:null,viewportBreakpoint:null,container:!1},b.prototype.fontSize=function(){var b,c;return b=a('<div style="font-size:1em;margin:0;padding:0;height:auto;line-height:1;border:0;">&nbsp;</div>').appendTo(this.el),c=b.height(),b.remove(),c},b.prototype.resize=function(){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D;y=this,this.fontSize=this.fontSize(),p=this.options.padding?this.options.padding*2:parseInt(this.el.parent().css("padding-left"))+parseInt(this.el.parent().css("padding-right")),q=this.options.padding?this.options.padding*2:parseInt(this.el.parent().css("padding-top"))+parseInt(this.el.parent().css("padding-bottom")),this.containerSize={width:this.container.width()-p,height:this.container.height()-q};if(this.containerSize.width>0&&this.containerSize.height>0){if(!this.keepSpans&&this.origFontSize!==this.fontSize){this.origFontSize=this.fontSize,z=0,g=0,b=Math.min(60,Math.floor(this.containerSize.width/(this.fontSize*this.ratio)));for(;;){this.ratio+=z,b=Math.min(60,Math.floor(this.containerSize.width/(this.fontSize*this.ratio))),k=this.fontSize*this.ratio*2,n=this.containerSize.height/k,d=n-this.text.length/b,A=this.text.length/10+5,z=d/(this.text.length/6+1),o=this.containerSize.width/(this.fontSize*b),i=.1;if(!((z>i||z<0-i)&&g<3))break;++g}m=[],j=[],B=0,c=0,u="",s="",f="";if(b!==h){h=b;while(B<this.words.length){s="";while(s.length<h){u=s,s+=this.words[B]+" ";if(++B>=this.words.length)break}t=h-u.length,r=s.length-h,t<r&&u.length>4?(f=u,B--):f=s,m.push(_.trim(f))}f.length<b/2&&(m[m.length-2]+=" "+m.pop());for(C=0,D=m.length;C<D;C++)x=m[C],j.push('<span class="lettering">'+(this.options.wrapAmpersand?x.replace("&",'<span class="amp">&amp;</span>'):_.trim(x))+"</span>");this.el.html(j.join(""))}}else this.origFontSize=this.fontSize;return w=[],l=this.keepSpans?this.keepSpans:j.length,a("span.lettering",this.el).each(function(){var b,c,e,f,g;b=a(this),e=b.text(),g=e.split(" ").length>2,b.css("word-spacing",0).css("letter-spacing",0).css("white-space","nowrap"),f=y.containerSize.width/b.width(),c=parseFloat(this.style.fontSize)||y.fontSize,w.push(c*f),b.css("font-size",Math.round(c*f)+"px"),d=y.containerSize.width-b.width();if(d)return b.css((g?"word":"letter")+"-spacing",(d/(g?e.split(" ").length-1:e.length)).toFixed(3)+"px")}),v=_.reduce(w,function(a,b){return a+b}),g=0,a("span.lettering",this.el).each(function(){var b;return b=a(this),k=Math.round(w[g]/(v/w.length)*(y.containerSize.height/l)),b.css("line-height",k+"px"),g++}),this.el.addClass("posterized")}throw e=new Error("Container not initialized"),e},a("#page").addClass("posterized"),b}(),a.fn.poster=function(c){return this.each(function(){var d,e;e=a(this),d=e.data("poster"),d||e.data("poster",d=new b(e,c));if(typeof c=="string")return d[c]()})}})(window.Zepto||window.jQuery)})).call(this);